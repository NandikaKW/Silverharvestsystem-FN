<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Staff Management System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="css/staff.css">
    <!-- Add these to the head section -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
<div class="container">
    <!-- Header -->
    <div class="header">
        <h1><i class="fas fa-users" style="color: #3498db;"></i> Staff Management System</h1>
        <div class="header-actions">
            <button class="btn-primary" id="openFormBtn">
                <i class="fas fa-user-plus"></i> Add New Staff
            </button>
            <button class="btn-icon" id="refreshBtn">
                <i class="fas fa-sync-alt"></i>
            </button>
        </div>
    </div>

    <!-- Stats Cards -->
    <div class="stats-container">
        <div class="stat-card fade-in" style="animation-delay: 0.1s;">
            <div class="stat-icon">
                <i class="fas fa-users"></i>
            </div>
            <div class="stat-info">
                <h4>Total Staff</h4>
                <p id="totalStaff">0</p>
            </div>
        </div>
        <div class="stat-card fade-in" style="animation-delay: 0.2s;">
            <div class="stat-icon" style="background: linear-gradient(135deg, #6c5ce7, #a29bfe);">
                <i class="fas fa-user-tie"></i>
            </div>
            <div class="stat-info">
                <h4>Managers</h4>
                <p id="managerCount">0</p>
            </div>
        </div>
        <div class="stat-card fade-in" style="animation-delay: 0.3s;">
            <div class="stat-icon" style="background: linear-gradient(135deg, #fd79a8, #fab1a0);">
                <i class="fas fa-user-cog"></i>
            </div>
            <div class="stat-info">
                <h4>Administrative</h4>
                <p id="administrativeCount">0</p>
            </div>
        </div>
        <div class="stat-card fade-in" style="animation-delay: 0.4s;">
            <div class="stat-icon" style="background: linear-gradient(135deg, #00b894, #00cec9);">
                <i class="fas fa-flask"></i>
            </div>
            <div class="stat-info">
                <h4>Scientists</h4>
                <p id="scientistCount">0</p>
            </div>
        </div>
    </div>

    <!-- Table Card -->
    <div class="table-card fade-in" style="animation-delay: 0.5s;">
        <div class="table-header">
            <h3><i class="fas fa-table"></i> All Staff Members</h3>
            <div class="table-actions">
                <button class="btn-icon" id="exportBtn"><i class="fas fa-download"></i></button>
                <button class="btn-icon" id="printBtn"><i class="fas fa-print"></i></button>
                <button class="btn-icon" id="filterBtn"><i class="fas fa-filter"></i></button>
                <div class="search-box" style="display: flex; align-items: center; background: white; border-radius: 8px; padding: 0.5rem; border: 1px solid var(--border-color);">
                    <i class="fas fa-search" style="margin: 0 0.5rem; color: var(--light-text);"></i>
                    <input type="text" id="searchInput" placeholder="Search staff..." style="border: none; outline: none; background: transparent;">
                </div>
            </div>
        </div>
        <div class="table-responsive">
            <table>
                <thead>
                <tr>
                    <th>Staff ID</th>
                    <th>Name</th>
                    <th>Designation</th>
                    <th>Role</th>
                    <th>Gender</th>
                    <th>Contact No</th>
                    <th>Email</th>
                    <th>Actions</th>
                </tr>
                </thead>
                <tbody id="staffTableBody">
                <!-- Data will be populated by JavaScript -->
                </tbody>
            </table>
        </div>
        <div id="loadingSpinner" class="spinner" style="display: none;"></div>
    </div>

    <!-- Report Section -->
    <div class="report-section fade-in" style="animation-delay: 0.6s;">
        <div class="report-header">
            <h3><i class="fas fa-chart-bar"></i> Staff Reports</h3>
            <button class="btn-primary" id="generateReportBtn">
                <i class="fas fa-file-export"></i> Generate Full Report
            </button>
        </div>
        <div class="report-grid">
            <div class="report-card">
                <h4><i class="fas fa-chart-pie"></i> Role Distribution</h4>
                <p>View distribution of staff across different roles. Analyze staff composition and hierarchy.</p>
                <button class="btn-secondary" style="margin-top: 1rem;" onclick="generateRoleReport()">
                    <i class="fas fa-chart-pie"></i> Generate Report
                </button>
            </div>
            <div class="report-card">
                <h4><i class="fas fa-venus-mars"></i> Gender Analysis</h4>
                <p>Analyze staff by gender distribution. Understand diversity in your workforce.</p>
                <button class="btn-secondary" style="margin-top: 1rem;" onclick="generateGenderReport()">
                    <i class="fas fa-chart-bar"></i> Generate Report
                </button>
            </div>
            <div class="report-card">
                <h4><i class="fas fa-calendar-alt"></i> Joining Trends</h4>
                <p>View staff joining trends over time. Identify hiring patterns and growth.</p>
                <button class="btn-secondary" style="margin-top: 1rem;" onclick="generateJoiningReport()">
                    <i class="fas fa-chart-line"></i> Generate Report
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Add/Edit Staff Popup -->
<div id="staffFormPopup" class="popup">
    <div class="popup-content">
        <div class="popup-header">
            <h3><i class="fas fa-user"></i> <span id="popupTitle">Add New Staff</span></h3>
            <button id="closePopupBtn" class="btn-icon"><i class="fas fa-times"></i></button>
        </div>
        <div class="popup-body">
            <form id="staffForm">
                <input type="hidden" id="editMode" value="false">
                <input type="hidden" id="editStaffId" name="staffId">

                <div class="form-grid">
                    <div class="form-group">
                        <label for="staffIdInput"><i class="fas fa-id-card"></i> Staff ID</label>
                        <input type="text" id="staffIdInput" name="staffId" required>
                    </div>

                    <div class="form-group">
                        <label for="firstNameInput"><i class="fas fa-signature"></i> First Name</label>
                        <input type="text" id="firstNameInput" name="firstName" required>
                    </div>

                    <div class="form-group">
                        <label for="lastNameInput"><i class="fas fa-signature"></i> Last Name</label>
                        <input type="text" id="lastNameInput" name="lastName" required>
                    </div>

                    <div class="form-group">
                        <label for="designationInput"><i class="fas fa-briefcase"></i> Designation</label>
                        <input type="text" id="designationInput" name="designation" required>
                    </div>

                    <div class="form-group">
                        <label for="genderInput"><i class="fas fa-venus-mars"></i> Gender</label>
                        <select id="genderInput" name="gender" required>
                            <option value="">Select Gender</option>
                            <option value="MALE">Male</option>
                            <option value="FEMALE">Female</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="roleInput"><i class="fas fa-user-tag"></i> Role</label>
                        <select id="roleInput" name="role" required>
                            <option value="">Select Role</option>
                            <option value="MANAGER">Manager</option>
                            <option value="ADMINISTRATIVE">Administrative</option>
                            <option value="SCIENTIST">Scientist</option>
                            <option value="OTHER">Other</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="joinedDateInput"><i class="fas fa-calendar-alt"></i> Joined Date</label>
                        <input type="date" id="joinedDateInput" name="joinedDate" required>
                    </div>

                    <div class="form-group">
                        <label for="dobInput"><i class="fas fa-birthday-cake"></i> Date of Birth</label>
                        <input type="date" id="dobInput" name="dob" required>
                    </div>

                    <div class="form-group">
                        <label for="contactNoInput"><i class="fas fa-phone"></i> Contact No</label>
                        <input type="tel" id="contactNoInput" name="contactNo" required>
                    </div>

                    <div class="form-group">
                        <label for="emailInput"><i class="fas fa-envelope"></i> Email</label>
                        <input type="email" id="emailInput" name="email" required>
                    </div>

                    <div class="form-group full-width">
                        <label for="addressInput"><i class="fas fa-home"></i> Address</label>
                        <textarea id="addressInput" name="address" required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="logCodeInput"><i class="fas fa-clipboard-list"></i> Log Code</label>
                        <input type="text" id="logCodeInput" name="logCode" required>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn-secondary" id="cancelBtn">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                    <button type="submit" class="btn-primary">
                        <i class="fas fa-save"></i> Save Staff
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- View Staff Popup -->
<div id="viewStaffPopup" class="popup">
    <div class="popup-content">
        <div class="popup-header">
            <h3><i class="fas fa-eye"></i> Staff Details</h3>
            <button class="btn-icon close-view-popup"><i class="fas fa-times"></i></button>
        </div>
        <div class="popup-body">
            <div id="staffDetails">
                <div class="detail-item">
                    <strong>Staff ID:</strong> <span id="detail-id">--</span>
                </div>
                <div class="detail-item">
                    <strong>Name:</strong> <span id="detail-name">--</span>
                </div>
                <div class="detail-item">
                    <strong>Designation:</strong> <span id="detail-designation">--</span>
                </div>
                <div class="detail-item">
                    <strong>Gender:</strong> <span id="detail-gender" class="status-badge">--</span>
                </div>
                <div class="detail-item">
                    <strong>Date of Birth:</strong> <span id="detail-dob">--</span>
                </div>
                <div class="detail-item">
                    <strong>Joined Date:</strong> <span id="detail-joinedDate">--</span>
                </div>
                <div class="detail-item">
                    <strong>Address:</strong> <span id="detail-address">--</span>
                </div>
                <div class="detail-item">
                    <strong>Contact No:</strong> <span id="detail-contactNo">--</span>
                </div>
                <div class="detail-item">
                    <strong>Email:</strong> <span id="detail-email">--</span>
                </div>
                <div class="detail-item">
                    <strong>Role:</strong> <span id="detail-role" class="status-badge">--</span>
                </div>
                <div class="detail-item">
                    <strong>Log Code:</strong> <span id="detail-logCode">--</span>
                </div>
            </div>
        </div>
        <!--        <div class="form-actions">-->
        <!--            <button type="button" class="btn-secondary close-view-popup">-->
        <!--                <i class="fas fa-times"></i> Close-->
        <!--            </button>-->
        <!--        </div>-->
    </div>
</div>

<!-- Report Modal -->
<div id="reportModal" class="popup">
    <div class="report-modal-content">
        <div class="report-modal-header">
            <h3><i class="fas fa-chart-bar"></i> <span id="reportModalTitle">Staff Report</span></h3>
            <button class="btn-icon close-report-modal"><i class="fas fa-times"></i></button>
        </div>
        <div class="report-modal-body">
            <div class="report-chart-container">
                <canvas id="reportChart"></canvas>
            </div>
            <!-- Add these buttons inside the report-modal-body after the chart container -->
            <div class="chart-actions">
                <button class="btn-secondary" id="exportChartBtn">
                    <i class="fas fa-download"></i> Export as Image
                </button>
                <button class="btn-primary" id="exportPdfBtn">
                    <i class="fas fa-file-pdf"></i> Export as PDF
                </button>
            </div>
            <div class="report-summary" id="reportSummary">
                <!-- Summary content will be added dynamically -->
            </div>
<!--            <div class="report-actions">-->
<!--                <button class="btn-secondary close-report-modal">-->
<!--                    <i class="fas fa-times"></i> Close-->
<!--                </button>-->
<!--            </div>-->
        </div>
    </div>
</div>

<script src="js/staff.js"></script>

</body>
</html>